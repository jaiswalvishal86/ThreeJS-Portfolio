<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portfolio - Vishal Jaiswal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../style.css" />
  </head>
  <body>
    <main>
      <section class="case-section">
        <div class="container">
          <h1 class="case-heading">Intro</h1>
          <p class="case-para">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit.
            Reprehenderit quo dolore suscipit quia sunt assumenda nemo
            temporibus, excepturi maiores tempore officia accusamus voluptatum
            dolorum numquam sit magnam inventore, velit veniam!
          </p>
          <br />
          <img
            src="https://d1zdxptf8tk3f9.cloudfront.net/ckeditor_assets/pictures/2509/content_geordanna-cordero-fields-762612-unsplash.jpg"
            alt=""
          />
        </div>
      </section>
      <section class="case-section">
        <div class="container">
          <h1 class="case-heading">Intro</h1>
          <p class="case-para">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit.
            Reprehenderit quo dolore suscipit quia sunt assumenda nemo
            temporibus, excepturi maiores tempore officia accusamus voluptatum
            dolorum numquam sit magnam inventore, velit veniam!
          </p>
          <br />
          <img
            src="https://www.adorama.com/alc/wp-content/uploads/2020/10/abstract-photography-design-feature.jpg"
            alt=""
          />
        </div>
      </section>
      <section class="case-section">
        <div class="container">
          <h1 class="case-heading">Intro</h1>
          <p class="case-para">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit.
            Reprehenderit quo dolore suscipit quia sunt assumenda nemo
            temporibus, excepturi maiores tempore officia accusamus voluptatum
            dolorum numquam sit magnam inventore, velit veniam!
          </p>
          <br />
          <img
            src="https://www.adorama.com/alc/wp-content/uploads/2020/10/abstract-photography-light-pattern-mirrors.jpg"
            alt=""
          />
        </div>
      </section>
    </main>
    <script>
      let minimap = document.createElement("div");
      let minimapSize = document.createElement("div");
      let viewer = document.createElement("div");
      let minimapContent = document.createElement("iframe");
      let scale = 0.1;
      let realScale;

      minimap.className = "minimap__container";
      minimapSize.className = "minimap__size";
      viewer.className = "minimap__viewer";
      minimapContent.className = "minimap__content";

      viewer.draggable = true;

      let isDragging = false;
      let startY = 0;

      minimap.append(minimapSize, viewer, minimapContent);
      document.body.appendChild(minimap);

      let html = document.documentElement.outerHTML.replace(
        /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
        ""
      );

      let iframeDoc = minimapContent.contentWindow.document;

      iframeDoc.open();
      iframeDoc.write(html);
      iframeDoc.close();

      function getDimension() {
        let bodyWidth = document.body.clientWidth;
        let bodyRatio = document.body.clientHeight / bodyWidth;
        let winRatio = window.innerHeight / window.innerWidth;

        minimap.style.width = "15%";

        realScale = minimap.clientWidth / bodyWidth;

        minimapSize.style.paddingTop = `${bodyRatio * 100}%`;

        viewer.style.paddingTop = `${winRatio * 100}%`;

        minimapContent.style.transform = `scale(${realScale})`;
        minimapContent.style.width = `${100 / realScale}%`;
        minimapContent.style.height = `${100 / realScale}%`;
      }

      function trackScroll() {
        viewer.style.transform = `translateY(${window.scrollY * realScale}px)`;
      }

      getDimension();

      function startDrag(event) {
        isDragging = true;
        startY = event.clientY || event.touches[0].clientY;
        event.preventDefault();
      }

      function drag(event) {
        if (isDragging) {
          const currentY = event.clientY || event.touches[0].clientY;
          const deltaY = currentY - startY;
          const scrollAmount = deltaY * 5;

          window.scrollBy(0, scrollAmount);

          startY = currentY;
        }
      }

      function stopDrag(event) {
        isDragging = false;
        event.preventDefault();
      }

      iframeDoc.addEventListener("click", function (e) {
        const iframeRect = minimapContent.getBoundingClientRect();
        const iframeLeft = iframeRect.left + window.scrollX;
        const iframeTop = iframeRect.top + window.scrollY;

        const clickXRelativeToIframe = e.clientX - iframeLeft;
        const clickYRelativeToIframe = e.clientY - iframeTop;

        const scrollX = window.scrollX + clickXRelativeToIframe;
        const scrollY = window.scrollY + clickYRelativeToIframe;

        window.scrollTo(scrollX, scrollY);
      });

      viewer.addEventListener("mousedown", startDrag);
      viewer.addEventListener("touchstart", startDrag);

      document.addEventListener("mousemove", drag);
      document.addEventListener("touchmove", drag);

      document.addEventListener("mouseup", stopDrag);
      document.addEventListener("touchend", stopDrag);

      window.addEventListener("resize", getDimension);
      window.addEventListener("scroll", trackScroll);
    </script>
  </body>
</html>
